<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户内容</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!--插件样式-->
    <link rel="stylesheet" href="../../plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../plugins/ztree/css/metroStyle/metroStyle.css">
    <link rel="stylesheet" href="../../plugins/datatables/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../../plugins/icheck/skins/square/green.css">
    <!--引入样式-->
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/customDataTable.css">

</head>
<body id="menu-content">
<div class="wrapper wrapper-content">
    <div class="ibox">
        <div class="ibox-title">
            <h5>操作管理</h5>
            <div class="ibox-tools">
                <a class="collapse-link">
                    <i class="fa fa-chevron-up"></i>
                </a>
                <a class="dropdown-toggle" data-toggle="dropdown" href="form_basic.html#" aria-expanded="false">
                    <i class="fa fa-wrench"></i>
                </a>
                <ul class="dropdown-menu dropdown-user">
                    <li><a href="#">选项1</a>
                    </li>
                    <li><a href="#">选项2</a>
                    </li>
                </ul>
                <a class="close-link">
                    <i class="fa fa-times"></i>
                </a>
            </div>
        </div>
        <!--按钮条-->
        <div class="ibox-content">
            <!--顶部搜索-->
            <div class="row">
                <div class="col-sm-12">
                    <div id="searchForm" class="form-inline">
                        <input type="hidden" id="treeId"  >
                        <div class="form-group">
                            <div class="company ">
                                <span>操作名称:</span>
                                <input id="operationNameId" name="operationNameId" class="form-control" type="hidden" value="">
                                <input id="operationName" name="nameParam" type="text" value="" data-msg-required=""
                                       class="form-control required" style="" aria-required="true">
                                <label id="companyName-error" class="error" for="operationName" style="display:none"></label>

                                <span >操作编码:</span>
                                <input id="proCodeId" name="proCodeId" class="form-control" type="hidden" value="">
                                <input id="operationCode" name="codeParam" type="text" value="" data-msg-required=""
                                       class="form-control required" style="" aria-required="true">
                                <label id="officeName-error" class="error" for="operationCode" style="display:none"></label>
                            </div>
                            <div class="user ">
                                <span>描&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;述:</span>
                                <input id="opeDescriptionId" name="opeDescriptionId" class="form-control" type="hidden" value="">
                                <input id="opeDescription" name="desParam" type="text" value="" data-msg-required=""
                                       class="form-control required" style="" aria-required="true">
                                <span >是否启用:</span>
                                <input id="enableId" name="enableId.id" class="form-control" type="hidden" value="">
                                <select id="enable" name="enable" class="form-control required">
                                    <option value="">全部</option>
                                    <option value="1">启用</option>
                                    <option value="0">禁用</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <br>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="pull-left">
                        <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="left"
                                onclick="openEditDialog('新增操作','./systemSettings/opeCheckView.html','800px','400px')" title="添加"><i class="fa fa-plus"></i> 添加
                        </button>

                        <button class="btn btn-white btn-sm" data-toggle="tooltip" data-placement="left"
                                onclick="edit('修改操作','./systemSettings/opeCheckView.html','800px','400px','#treeTable')" title="修改"><i class="fa fa-file-text-o"></i> 修改
                        </button>
                        <button class="btn btn-white btn-sm" onclick="deleteAll('确认要删除该用户吗？','/api/sys/SysOperation/delete/','#treeTable')"  data-toggle="tooltip" data-placement="top"><i
                                class="fa fa-trash-o"></i>删除</button>
                        <button class="btn btn-white btn-sm " id="refresh-btn" data-toggle="tooltip" data-placement="left"
                                onclick="window.location.reload()" title="刷新"><i class="glyphicon glyphicon-repeat"></i> 刷新
                        </button>
                    </div>
                    <div class="pull-right">
                        <button class="btn btn-white btn-rounded btn-outline btn-sm " id="search-btn"><i
                                class="fa fa-search"></i> 查询
                        </button>
                        <button class="btn btn-white btn-rounded btn-outline btn-sm " id="reset-btn"><i
                                class="fa fa-refresh"></i> 重置
                        </button>
                    </div>
                </div>
            </div>
            <!--内容表格-->
            <table id="treeTable"
                   class="table table-striped table-bordered table-hover table-condensed dataTables-example dataTable">
                <thead>
                <tr class="alignCenter">
                    <th><input type="checkbox" class="i-checks" style="position: absolute; opacity: 0;"></th>
                    <th>序号	</th>
                    <th>操作名称	</th>
                    <th>操作编码	</th>
                    <th>描述	</th>
                    <th>排序	</th>
                    <th>是否启用	</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
            <div class="clearfix pagination-box">
                <div class="page-info pull-left"></div>
                <div id="pagination" class="pagination-roll pull-right"></div>
            </div>
        </div>
    </div>
</div>
</body>
<!--核心插件-->
<script src="../../js/jquery-2.2.4.min.js"></script>
<script src="../../plugins/bootstrap/js/bootstrap.min.js"></script>
<!--附属插件-->
<script src="../../plugins/ibox.2.2/ibox.js"></script>
<script src="../../plugins/layer/layer.js"></script>
<script src="../../plugins/icheck/icheck.min.js"></script>
<script src="../../plugins/metismenu-master/metisMenu.min.js"></script>
<script src="../../plugins/slimScroll/jquery.slimscroll.min.js"></script>
<script src="../../plugins/ztree/js/jquery.ztree.core.js"></script>
<script src="../../plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="../../plugins/treetable/jquery.treetable.js"></script>
<script src="../../plugins/bootStrapPager/js/extendPagination.js"></script>
<!--页面依赖js-->
<script src="../../js/public.js"></script>
<script src="../../js/common.js"></script>
<script src="../../js/jeeplus.js"></script>
<script src="../../js/apiDomain.js"></script>
<script src="../../js/customForm.js"></script>
<script src="../../js/page.js"></script>
<script>
    $(function () {
        window.pageLoad = function () {
            var data = {
                nameParam: $("#operationName").val(),
                codeParam: $('#operationCode').val(),
                desParam: $('#opeDescription').val(),
                enable:   $('#enable').val(),
            };
            Page.init("/api/sys/SysOperation/page", data, true, function (tableData) {
                dataout(tableData);
                $('tbody tr').attr('class','alignCenter');
                $('.btn-check').click(function () {
                    var id = $(this).parents("tr").find('.i-checks').attr('id');
                    openDialog('查看属性信息', './systemSettings/opeCheckView.html?id=' + id, '800px', '400px')
                });
                $('.btn-change').click(function () {
                    var id = $(this).parents("tr").find('.i-checks').attr('id');
                    openEditDialog('修改属性', './systemSettings/opeCheckView.html?id=' + id, '800px', '400px')
                });
                $('.btn-delete').click(function () {
                    var id = $(this).parents("tr").find('.i-checks').attr('id');
                    deleteItem('确定要删除该属性吗', '/api/sys/SysOperation/delete',id)
                });
            });
        };

        var treeId = getQueryString("treeId");
        $('#treeId').val(treeId);


        pageLoad();
        windowclick();
        //点击重置按钮
        $("#reset-btn").click(function () {
            $("#operationName").val("");
            $('#operationCode').val("");
            $('#opeDescription').val("");
            $('#enable').val("");
            Page.reset(["nameParam","codeParam","desParam","enable"]);
        });

    });
    //   ajax请求渲染datatable数据
    function dataout(data) {
        $('#treeTable').dataTable({
            "bSort":false,
            "bPaginate": false,
            "bAutoWidth": false,
            "bDestroy": true,
            "paging": false,
            "bProcessing": true,
            "searching": false, //禁用aa原生搜索
            "info": false,  //底部文字
            "order": [],
            "pagingType": "full_numbers",
            "oLanguage": lang,
            "data": data,
            //定义列 宽度 以及在json中的列名
            "columns": [
                {
                    "data": null, "defaultContent": "",
                    "render": function (data, type, row, meta) {
                        return data = "<input type='checkbox' id=" + row.id + " class='i-checks'>"
                    }
                },
                {"data": null,"width":"6%" },
                {"data": "name",'sClass':"alignCenter  "},
                {"data": "code",'sClass':"alignCenter","width":"15%"},
                {"data": "des", 'sClass':"alignCenter","width":"15%"},
                {"data": "sort","width":"6%" },
                {
                    "data": null,"width":"6%",
                    "render":function (data) {
                        if(data.enable==0){
                            return data = '否'
                        }else{
                            return data = '是'
                        }
                    }
                },
                {"data": "id", "orderable": false, "defaultContent": "",
                    "render": function (data, type, row, meta) {
                        return data = "<a class='btn btn-info btn-xs  btn-check'><i class='fa fa-search-plus'></i>查看</a >" +
                            "<a class='btn btn-success btn-xs btn-change'><i class='fa fa icon-change'></i>修改</a >" +
                            "<a class='btn btn-danger btn-xs btn-delete'><i class='fa fa-trash' ></i>删除</a >"
                    }
                }],
            "fnDrawCallback" : function(){
                this.api().column(1).nodes().each(function(cell, i) {
                    cell.innerHTML =  i + 1;
                });
            },

        });
        RenderiCheckTblBody();
    }

    //    function openCheckView(title,url,width,height,innerCallbackFn){
    //        if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){//如果是移动端，就使用自适应大小弹窗
    //            width='auto';
    //            height='auto';
    //        }else{//如果是PC端，根据用户设置的width和height显示。
    //
    //        };
    //        var btns = ['关闭'];
    //        if(innerCallbackFn){
    //            btns = ['确定', '关闭'];
    //        };
    //        var layConfig = {
    //            type: 2,
    //            area: [width, height],
    //            title: title,
    //            maxmin: true, //开启最大化最小化按钮
    //            content: url ,
    //            btn: btns
    //        };
    //        if(innerCallbackFn) {
    //            layConfig.yes =  function(index, layero){
    //                var body = top.layer.getChildFrame('body', index);  //获取子iframe
    //                var iframeWin = layero.find('iframe')[0]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
    //                var inputForm = body.find('#inputForm');
    //                if(innerCallbackFn){
    //                    innerCallbackFn(iframeWin.contentWindow,body,index);
    //                }
    //            },
    //                layConfig. cancel = function(index){
    //
    //                }
    //        }else{
    //            layConfig.yes = function (index) {
    //                top.layer.close(index);
    //
    //            }
    //        }
    //
    //
    //        var ind =  top.layer.open(layConfig);
    //    }




</script>

</html>