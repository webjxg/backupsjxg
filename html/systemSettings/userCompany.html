<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>公司</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="../../plugins/ztree/css/metroStyle/metroStyle.css">
    <script src="../../js/jquery-2.2.4.min.js"></script>
    <script src="../../plugins/ztree/js/jquery.ztree.core.min.js"></script>
    <script src="../../plugins/layer/layer.js"></script>
    <script src="../../js/apiDomain.js"></script>

</head>
<body>
    <div id="tree" class="ztree leftBox-content">

    </div>
    <script>
        $(document).ready(function() {
            var data = {
                type:"1"
            }
            ajaxToServer1(admin_domain+'/api/sys/SysOrg/selectOrg',data, ztreecompany);
        });


//留着后面使用
//        function setDefaultVal(val){
//            if(val && val.length>0){
//                var nodes = zTreeObj.getNodesByParam("id", val,  null);
//                if(nodes.length > 0){
//                    zTreeObj.selectNode(nodes[0]);
//                }
//            }
//        }

//  卢毛赛于2018/6/9修改，不让用户点击归属公司的根节点
        var zTreeObj;
        function ztreecompany(data) {
            var da=data.rows;
            var arr = [];
            da.filter(function (a) {
                // if (a.pId == 0) {
                arr.push(a)
                // }
            })
            var setting = {
                data: {
                    simpleData: {
                        enable: true,   //设置是否使用简单数据模式(Array)
                        idKey: "id",    //设置节点唯一标识属性名称
                        pIdKey: "pId"      //设置父节点唯一标识属性名称
                    },
                    key: {
                        name: "name",//zTree 节点数据保存节点名称的属性名称
                        title: "name" //zTree 节点数据保存节点提示信息的属性名称
                    }
                }
            };

            var zNodes = arr;
            zTreeObj= $.fn.zTree.init($('#tree'), setting, zNodes);
            var nodes = zTreeObj.getNodes();
            for (var i = 0; i < nodes.length; i++) { //设置节点展开
                zTreeObj.expandNode(nodes[i], true, false, true);
            }
            if(zTreeObj)
            {return getSelectVal}
        }






    </script>

    <!--引入公共方法-->
    <script src="../../js/public.js"></script>
    <script src="../../js/customForm.js"></script>
</body>
</html>