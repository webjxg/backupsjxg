<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>指令下达</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="../../plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../plugins/font-awesome/css/font-awesome.min.css">
    <!--引入样式-->
    <link rel="stylesheet" href="../../plugins/layer/theme/default/layer.css">
    <link rel="stylesheet" href="../../plugins/ztree/css/metroStyle/metroStyle.css">
    <!--样式-->
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/customDatagrid.css">
    <link rel="stylesheet" href="../../css/customDataTable.css">
    <link rel="stylesheet" href="../../css/aps.css">
    <style>
        .wrapper{
            height: 1074px;
        }
        .ibox{
            background-color: #f3f3f4;
            position: relative;
        }
        .ibox-content:nth-of-type(1){
            margin-bottom: 20px;
        }
        .ibox-content:nth-of-type(2){
            height: 668px;
            float:left;
            margin-right: 20px;

        }
        .ibox-content:nth-of-type(3){
            position: absolute;
            right:0;
            width: 75%;
        }
    </style>
</head>
<body>
<div class="wrapper wrapper-content bg-gray">
    <div class="ibox">
        <!--标题 按钮-->
        <div class="ibox-content">
            <div>
                <h1 class="titName">指令下达</h1>
            </div>
            <!--按钮-->
            <div class="clearfix">
                <div class="apsType-box pull-left mgb-10">
                    <ul class="apsType-linkage">
                        <li class="job">
                            工序：
                            <select name="job" id="job">
                                <option value="">请选择</option>
                                <option value="id0001">原料</option>
                                <option value="id0002">加工</option>
                                <option value="id0003">生产</option>
                                <option value="id0004">销售</option>
                            </select>
                        </li>
                        <li class="rank">
                            指令级别：
                            <select name="rank" id="rank">
                                <option value="">请选择</option>
                                <option value="id0005">一级</option>
                                <option value="id0006">二级</option>
                                <option value="id0007">三级</option>
                                <option value="id0008">四级</option>
                            </select>
                        </li>
                        <li class="grade">
                            指令分类：
                            <select name="grade" id="grade">
                                <option value="">请选择</option>
                                <option value="id0010">调度指令</option>
                                <option value="id0011">计划指令</option>
                                <option value="id0012">原料加工指令</option>
                                <option value="id0013">厉害了指令</option>
                            </select>
                        </li>
                        <li class="order">
                            指令：
                            <input type="text" style="width: 120px" id="orders" class="form-control" name="orders">
                        </li>

                    </ul>
                </div>
            </div>
        </div>
        <!--左侧ztree-->
        <div class="ibox-content">
            <!--左侧树-->
            <div class="leftBox" >
                <div id="tree" class="ztree leftBox-content"></div>
            </div>
            <!--内容区-->
        </div>
        <!--右侧内容 iframe-->
        <div class="ibox-content">
            <iframe id="officeContent" name="officeContent" width="100%" height="650px" frameborder="0"></iframe>
        </div>
    </div>
</div>


</body>
<script src="../../js/jquery-2.2.4.min.js"></script>
<script src="../../plugins/bootstrap/js/bootstrap.min.js"></script>
<!--附属插件-->
<script src="../../plugins/layer/layer.js"></script>
<script src="../../plugins/icheck/icheck.min.js"></script>
<script src="../../plugins/datetimepicker/js/bootstrap-datetimepicker.js"></script>
<script src="../../plugins/datatables/js/jquery.dataTables.min.js"></script>
<script src="../../plugins/datatables/js/dataTables.bootstrap.js"></script>
<script src="../../plugins/bootStrapPager/js/extendPagination.js"></script>
<script src="../../plugins/ztree/js/jquery.ztree.core.js"></script>
<!--自定义文件-->
<script src="../../js/customForm-aps.js"></script>
<script src="../../js/page.js"></script>

<script>
    $(document).ready(function(){
//        page='orgInner.html';
        $('#officeContent').attr('src','./giveOrdersInner.html');
        ajaxToServer1('/api/aps/Dict/tree',{},function (da) {
            zTree(da.rows)
        });
        reloadZtree();
    });
    //ztree渲染
    function zTree(da) {
        var zTreeObj;
        // zTree 的参数配置，深入使用请参考 API 文档（setting 配置详解）
        var setting = {
            data: {
                simpleData: {
                    enable: true,   //设置是否使用简单数据模式(Array)
                    idKey: "id",    //设置节点唯一标识属性名称
                    pIdKey: "pId"      //设置父节点唯一标识属性名称
                },
                key: {
                    name: "name",//zTree 节点数据保存节点名称的属性名称
                    title: "name"//zTree 节点数据保存节点提示信息的属性名称
                }
            },
            callback: {
                onClick: function (e, treeId, node){
                    if(node.id){
                        rendersun(node.id)
                    }
                }
            }

        };
        // zTree 的数据属性，深入使用请参考 API 文档（zTreeNode 节点数据详解）
        var zNodes = da;
        //执行ztree
        var treeObj =$.fn.zTree.init($("#tree"), setting, zNodes);

    }

    //选择框变更后ztree刷新数据
    function reloadZtree(){
        $('#job').change(function () {
            ajaxToServer1('/api/aps/Dict/tree/',{},function (da) {
                zTree(da.rows)
            });
        });
        $('#rank').change(function () {
            ajaxToServer1('/api/aps/Dict/tree/',{},function (da) {
                zTree(da.rows)
            });
        });
        $('#grade').change(function () {
            ajaxToServer1('/api/aps/Dict/tree/',{},function (da) {
                zTree(da.rows)
            });
        })
        $('#orders').change(function () {
            ajaxToServer1('/api/aps/Dict/tree/',{},function (da) {
                zTree(da.rows)
            });
        })
    }





    //点ztree传值id
    function rendersun(data) {
        $('#officeContent')[0].contentWindow.updatason(data);
    }
</script>



</html>